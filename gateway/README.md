# CBDC Gateway

åŸºäº Hyperledger Fabric çš„å¤®è¡Œæ•°å­—è´§å¸ (CBDC) ç½‘å…³æœåŠ¡ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. åˆ›å»ºç”¨æˆ·èº«ä»½

é¦–å…ˆä¸ºæ‰€æœ‰ç»„ç»‡çš„æ‰€æœ‰ç”¨æˆ·åˆ›å»ºèº«ä»½æ–‡ä»¶ï¼š

```bash
npm run create:identities
```

æˆ–è€…ç›´æ¥è¿è¡Œï¼š

```bash
node createAllIdentities.js
```

### 3. é€‰æ‹©ç”¨æˆ·èº«ä»½

é€‰æ‹©è¦ä½¿ç”¨çš„ç”¨æˆ·èº«ä»½ï¼š

```bash
# äº¤äº’å¼é€‰æ‹©
npm run user:select

# æˆ–è€…ç›´æ¥æŒ‡å®šç”¨æˆ·
node cli/selectUser.js -select admin

# æŸ¥çœ‹å½“å‰ç”¨æˆ·
npm run user:current

# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨ç”¨æˆ·
npm run user:list
```

### 4. æ‰§è¡Œæ“ä½œ

ç°åœ¨å¯ä»¥æ‰§è¡Œå„ç§ CBDC æ“ä½œï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨å½“å‰é€‰æ‹©çš„ç”¨æˆ·èº«ä»½ï¼š

```bash
# åˆå§‹åŒ– CBDC ä»£å¸
npm run init

# é“¸é€ ä»£å¸
npm run mint

# é”€æ¯ä»£å¸
npm run burn
```

## ğŸ“‹ åŠŸèƒ½ç‰¹æ€§

### ğŸ” ç”¨æˆ·èº«ä»½ç®¡ç†

- **è‡ªåŠ¨èº«ä»½é€‰æ‹©**: ä¸€æ¬¡é€‰æ‹©ï¼Œå¤šæ¬¡ä½¿ç”¨
- **èº«ä»½åˆ‡æ¢**: æ”¯æŒåœ¨ä¸åŒç”¨æˆ·é—´å¿«é€Ÿåˆ‡æ¢
- **æƒé™æç¤º**: æ¯æ¬¡æ“ä½œéƒ½æ˜¾ç¤ºå½“å‰ç”¨æˆ·èº«ä»½
- **å¤šç»„ç»‡æ”¯æŒ**: æ”¯æŒæ‰€æœ‰ç»„ç»‡çš„æ‰€æœ‰ç”¨æˆ·

### ğŸ’° CBDC æ“ä½œ

- **åˆå§‹åŒ–**: åˆ›å»º CBDC ä»£å¸åˆçº¦
- **é“¸é€ **: å¤®è¡Œé“¸é€ æ–°ä»£å¸
- **é”€æ¯**: å¤®è¡Œé”€æ¯ä»£å¸
- **è½¬è´¦**: ä»£å¸è½¬è´¦å’Œæˆæƒç®¡ç†
- **å¯ŒæŸ¥è¯¢**: äº¤æ˜“è®°å½•æŸ¥è¯¢å’Œåˆ†é¡µåŠŸèƒ½
- **è´¦æˆ·æŸ¥è¯¢**: æŸ¥è¯¢è´¦æˆ·ä¿¡æ¯ã€ä½™é¢ã€ç”¨æˆ·ä¿¡æ¯ç­‰

## ğŸ› ï¸ å‘½ä»¤è¡Œå·¥å…·

### ç”¨æˆ·ç®¡ç†

```bash
# åˆ—å‡ºæ‰€æœ‰å¯ç”¨ç”¨æˆ·
npm run user:list

# æ˜¾ç¤ºå½“å‰é€‰æ‹©çš„ç”¨æˆ·
npm run user:current

# äº¤äº’å¼é€‰æ‹©ç”¨æˆ·
npm run user:select

# é€‰æ‹©æŒ‡å®šç”¨æˆ·
node cli/selectUser.js -select <ç”¨æˆ·å>

# æ¸…é™¤å½“å‰ç”¨æˆ·é€‰æ‹©
npm run user:clear
```

### CBDC æ“ä½œ

```bash
# åˆå§‹åŒ– CBDC ä»£å¸
npm run init

# é“¸é€ ä»£å¸
npm run mint

# é”€æ¯ä»£å¸
npm run burn

# è½¬è´¦ (äº¤äº’æ¨¡å¼)
npm run transfer

# å¯ŒæŸ¥è¯¢ (äº¤äº’æ¨¡å¼)
npm run query

# è´¦æˆ·æŸ¥è¯¢ (äº¤äº’æ¨¡å¼)
npm run account

# è½¬è´¦ (å‘½ä»¤è¡Œæ¨¡å¼)
npm run transfer -- -t transfer -to <æ¥æ”¶è€…åœ°å€> -a 100                    # ç›´æ¥è½¬è´¦
npm run transfer -- -t transferfrom -from <å‘é€è€…åœ°å€> -to <æ¥æ”¶è€…åœ°å€> -a 50  # æˆæƒè½¬è´¦
npm run transfer -- -t approve -spender <è¢«æˆæƒè€…åœ°å€> -a 200               # æ‰¹å‡†æˆæƒ

# å¯ŒæŸ¥è¯¢ (å‘½ä»¤è¡Œæ¨¡å¼)
npm run query -- -t transactions -u <ç”¨æˆ·ID> --minamount 100 --maxamount 1000 --transactiontype transfer  # åŸºç¡€å¯ŒæŸ¥è¯¢
npm run query -- -t transactionspage -u <ç”¨æˆ·ID> --pagesize 20 --offset 0                                # åˆ†é¡µæŸ¥è¯¢
npm run query -- -t transactionsbookmark -u <ç”¨æˆ·ID> --pagesize 15 --bookmark <ä¹¦ç­¾>                      # ä¹¦ç­¾åˆ†é¡µæŸ¥è¯¢
npm run query -- -t history -u <ç”¨æˆ·ID> --pagesize 50 --offset 0                                          # äº¤æ˜“å†å²æŸ¥è¯¢

# è´¦æˆ·æŸ¥è¯¢ (å‘½ä»¤è¡Œæ¨¡å¼)
npm run account -- -t account                    # æŸ¥è¯¢å½“å‰å®¢æˆ·ç«¯è´¦æˆ·ä¿¡æ¯
npm run account -- -t account -u <ç”¨æˆ·ID>        # æŸ¥è¯¢æŒ‡å®šç”¨æˆ·è´¦æˆ·ä¿¡æ¯
npm run account -- -t userinfo                   # æŸ¥è¯¢ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
npm run account -- -t balance                    # æŸ¥è¯¢å½“å‰å®¢æˆ·ç«¯ä½™é¢
npm run account -- -t balance -a <è´¦æˆ·åœ°å€>      # æŸ¥è¯¢æŒ‡å®šè´¦æˆ·ä½™é¢
npm run account -- -t accountid                  # æŸ¥è¯¢å®¢æˆ·ç«¯è´¦æˆ·ID
npm run account -- -t allowance --owner <æˆæƒè€…> --spender <è¢«æˆæƒè€…>  # æŸ¥è¯¢æˆæƒé¢åº¦

# å¸¦å‚æ•°æ‰§è¡Œ
node cli/init.js -name "Digital Yuan" -symbol "DCEP" -decimals "2"
node cli/mint.js -amount "1000"
node cli/burn.js -amount "500"
node cli/transfer.js -t transfer -to <æ¥æ”¶è€…åœ°å€> -a 100
node cli/query.js -t transactions -u <ç”¨æˆ·ID> --minamount 100 --maxamount 1000
```

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æœåŠ¡å±‚

- **BaseService**: åŸºç¡€ç½‘ç»œè¿æ¥å’Œäº¤æ˜“æœåŠ¡
- **TokenService**: CBDC ä»£å¸ç›¸å…³æ“ä½œ

### ç”¨æˆ·ç®¡ç†

- **èº«ä»½æ–‡ä»¶**: å­˜å‚¨åœ¨ `wallet/` ç›®å½•
- **å½“å‰ç”¨æˆ·**: å­˜å‚¨åœ¨ `.current-user` æ–‡ä»¶ä¸­
- **è‡ªåŠ¨æç¤º**: æ¯æ¬¡æ“ä½œå‰æ˜¾ç¤ºå½“å‰ç”¨æˆ·ä¿¡æ¯

### æƒé™æ§åˆ¶

- **å¤®è¡Œæ“ä½œ**: é“¸é€ ç­‰æ•æ„Ÿæ“ä½œä»…é™å¤®è¡Œèº«ä»½
- **èº«ä»½éªŒè¯**: è‡ªåŠ¨éªŒè¯ç”¨æˆ·èº«ä»½å’Œæƒé™
- **æ“ä½œå®¡è®¡**: è®°å½•æ‰€æœ‰æ“ä½œçš„æ‰§è¡Œç”¨æˆ·

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œç‰¹å®šåŠŸèƒ½æµ‹è¯•
npm run test:init
npm run test:mint
npm run test:burn

# æµ‹è¯•è¦†ç›–ç‡
npm run test:coverage
```

## ğŸ“ ç›®å½•ç»“æ„

```
gateway/
â”œâ”€â”€ cli/                    # å‘½ä»¤è¡Œå·¥å…·
â”‚   â”œâ”€â”€ init.js            # åˆå§‹åŒ–å·¥å…·
â”‚   â”œâ”€â”€ mint.js            # é“¸é€ å·¥å…·
â”‚   â”œâ”€â”€ burn.js            # é”€æ¯å·¥å…·
â”‚   â”œâ”€â”€ transfer.js        # è½¬è´¦å·¥å…·
â”‚   â”œâ”€â”€ query.js           # å¯ŒæŸ¥è¯¢å·¥å…·
â”‚   â”œâ”€â”€ account.js         # è´¦æˆ·æŸ¥è¯¢å·¥å…·
â”‚   â””â”€â”€ selectUser.js      # ç”¨æˆ·é€‰æ‹©å·¥å…·
â”œâ”€â”€ services/              # æœåŠ¡å±‚
â”‚   â”œâ”€â”€ BaseService.js     # åŸºç¡€æœåŠ¡
â”‚   â””â”€â”€ TokenService.js    # ä»£å¸æœåŠ¡
â”œâ”€â”€ tests/                 # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ wallet/                # ç”¨æˆ·èº«ä»½æ–‡ä»¶
â”œâ”€â”€ createAllIdentities.js # èº«ä»½åˆ›å»ºè„šæœ¬
â””â”€â”€ README.md             # è¯´æ˜æ–‡æ¡£
```

## ğŸ”§ é…ç½®

### ç½‘ç»œé…ç½®

ç³»ç»Ÿä½¿ç”¨æ ¹ç›®å½•çš„ `network-config.json` æ–‡ä»¶è¿›è¡Œç½‘ç»œé…ç½®ã€‚

### èº«ä»½ç®¡ç†

- èº«ä»½æ–‡ä»¶å­˜å‚¨åœ¨ `wallet/` ç›®å½•
- å½“å‰ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åœ¨ `.current-user` æ–‡ä»¶
- æ”¯æŒæ‰€æœ‰ç»„ç»‡çš„æ‰€æœ‰ç”¨æˆ·èº«ä»½

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. **æƒé™æ§åˆ¶**: é“¸é€ æ“ä½œä»…é™å¤®è¡Œèº«ä»½æ‰§è¡Œ
2. **èº«ä»½é€‰æ‹©**: æ¯æ¬¡æ“ä½œå‰éƒ½ä¼šæ˜¾ç¤ºå½“å‰ç”¨æˆ·èº«ä»½
3. **èº«ä»½æ–‡ä»¶**: ç¡®ä¿èº«ä»½æ–‡ä»¶å®Œæ•´ä¸”æœ‰æ•ˆ
4. **ç½‘ç»œè¿æ¥**: ç¡®ä¿ Fabric ç½‘ç»œæ­£å¸¸è¿è¡Œ

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š

1. ç½‘ç»œé…ç½®æ˜¯å¦æ­£ç¡®
2. èº«ä»½æ–‡ä»¶æ˜¯å¦å­˜åœ¨
3. å½“å‰ç”¨æˆ·æ˜¯å¦å·²é€‰æ‹©
4. æƒé™æ˜¯å¦è¶³å¤Ÿ


